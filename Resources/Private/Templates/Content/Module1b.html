{namespace flux=FluidTYPO3\Flux\ViewHelpers}
{namespace v=Tx_Vhs_ViewHelpers}

<div xmlns="http://www.w3.org/1999/xhtml"
     xmlns:f="http://fluidtypo3.org/schemas/fluid-master.xsd"
     xmlns:flux="http://fluidtypo3.org/schemas/flux-master.xsd"
     xmlns:v="http://fluidtypo3.org/schemas/vhs-master.xsd">

    <f:layout name="Content"/>



    <f:section name="Configuration">

        <flux:form wizardTab="CFM Inhalts Module" id="module1b" icon="{v:extension.path.resources(path: 'Icons/icon-cfm.gif')}">

            <flux:form.sheet name="leftcontent">
                <flux:field.input name="titlesmall"/>
                <flux:field.input name="title"/>
                <flux:field.text name="maintext" enableRichText="true"/>
            </flux:form.sheet>


            <flux:form.sheet name="rightcontent">

                <flux:field.select name="mode" items="text,image, slider" requestUpdate="TRUE" label="InhaltsElement"/>

                <f:if condition="{0:mode} == {0:'text'}">
                    <flux:field.text name="advtext" enableRichText="TRUE"/>
                </f:if>

                <f:if condition="{0:mode} == {0:'image'}">
                    <flux:field.text name="alt" rows="1" cols="60" enableRichText="false"/>
                    <flux:field.file name="file"/>
                </f:if>

                <f:if condition="{0:mode} == {0:'slider'}">
                    <flux:form.section name="slides">
                        <flux:form.object name="slideelement">
                            <flux:field.text name="title" rows="1" cols="60" enableRichText="false"  required="true"/>
                            <flux:field.text name="slidetext" rows="8" cols="60" enableRichText="true"  required="true"/>
                        </flux:form.object>
                    </flux:form.section>
                </f:if>

            </flux:form.sheet>
        </flux:form>

    </f:section>

    <f:section name="Preview">
        <p>Inhaltselement: Modul 1</p>

    </f:section>

    <f:section name="Previewold">
        <table width="100%" border="0">
            <tr>
                <td colspan="3"><strong>Inhaltselement: Modul 1</strong></td>
            </tr>
            <tr>
                <td width="49%">
                    <f:if condition="titlesmall"><h3>{titlesmall}</h3></f:if>
                    <f:if condition="title"><h2>{title}</h2><br /></f:if>
                    <f:if condition="{maintext}"><f:format.crop maxCharacters="100">{maintext}</f:format.crop><br /></f:if>
                </td>
                <td width="2%">&nbsp;</td>
                <td width="49%">
                    <f:for each="{elements}" as="test" key="schluessel" >
                        <f:if condition="{schluessel} > 0"> {schluessel} --</f:if>
                    </f:for>

                    <f:if condition="{elements.1}">
                        <f:then>


                            <f:for each="{elements}" as="element" iteration="iteration">
                                <f:if condition="{iteration}">

                                    <f:if condition="{element.image}">
                                        <img src="/{element.image.file}" width="100%" alt="{element.image.alt}" />
                                    </f:if>
                                    <f:if condition="{element.text}">
                                        <f:format.crop maxCharacters="80">{element.text.advtext}</f:format.crop>
                                    </f:if>
                                    <f:if condition="{element.slider}">

                                        <f:if condition="{element.slider -> f:count()}>6"><p style="color: red;">Es sind {elements -> f:count()} Elemente hinzugefügt, es können aber nur die ersten 5 angezeigt werden.</p></f:if>
                                        <f:if condition="{element.slider -> f:count()}>1">

                                            <b>Slider:</b>
                                            <table>
                                                <tr>
                                                    <f:for each="{element.slider.slides}" as="slide">
                                                        <f:if condition="{slide.slideelement}">
                                                            <td style="padding-right: 10px; border-right: 1px lightgray solid;">
                                                                <f:if condition="{slide.slideelement.title}"><b><f:format.crop maxCharacters="15">{slide.slideelement.title}</f:format.crop></b><br /></f:if>
                                                                <f:if condition="{slide.slidetext}"><f:format.crop maxCharacters="15">{slide.slidetext}</f:format.crop></f:if>
                                                            </td>
                                                        </f:if>
                                                    </f:for>
                                                </tr>
                                            </table>
                                        </f:if>
                                    </f:if>
                                </f:if>

                            </f:for>
                        </f:then>
                    </f:if>
                </td>
            </tr>

        </table>


    </f:section>

    <f:section name="Main">

        <div id="modul_1">
            <div class="row">
                <div class="columns large-12 pad_null">
                    <div class="columns large-6 bg_grey">
                        <div class="columns large-4 modul_1_links_leer">&nbsp;</div>
                        <div class="columns large-8 modul_1_links">
                            <f:if condition="titlesmall"><h1 class="uppercase bgcolor_grey">{titlesmall}</h1></f:if>
                            <f:if condition="title"><h1 class="uppercase bgcolor_grey"><b>{title}</b></h1></f:if>
                            <f:if condition="maintext"><f:format.nl2br>{maintext}</f:format.nl2br></f:if>
                        </div>
                    </div>
                    <div class="columns large-6 bg_white pad_null">
                        <div class="columns large-8 modul_1_rechts">
                            <f:if condition="{elements -> f:count()}">
                                <f:then>
                                    <f:for each="{elements}" as="element" iteration="iteration">
                                        <f:if condition="{iteration.isFirst}">
                                            <f:if condition="{element.image}"><img src="/{element.image.file}" alt="{element.image.alt}" /></f:if>
                                            <f:if condition="{element.text}">
                                                {element.text.advtext}
                                            </f:if>
                                            <f:if condition="{element.slider}">
                                                <f:for each="{element.slider.slides}" as="slide" iteration="count">
                                                    <f:if condition="{slide.slideelement}">
                                                        <td style="padding-right: 10px; border-right: 1px lightgray solid;">
                                                            {count.cycle}:<b><f:format.crop maxCharacters="15">{slide.slideelement.title}</f:format.crop>:</b>{slide.slideelement.slidetext}<br />
                                                        </td>
                                                    </f:if>
                                                </f:for>
                                            </f:if>
                                        </f:if>

                                    </f:for>
                                </f:then>
                            </f:if>
                        </div>
                        <div class="columns large-4">&nbsp;</div>

                    </div>
                </div>
            </div>
        </div>

    </f:section>




</div>
